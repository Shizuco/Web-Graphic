<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>04.00 - Тіні </title>
	<script src="./js/three.js"></script>
	<script src="./js/TrackballControls.js"></script>

</head>

<body>

	<script>


		init();

		function init() {

			// створюємо рендер і задаємо розмір
			var renderer = window.WebGLRenderingContext ? new THREE.WebGLRenderer({ antialias: true }) : new THREE.CanvasRenderer();
			renderer.setClearColor(new THREE.Color(0xEEEEEE));
			renderer.setSize(window.innerWidth, window.innerHeight);


			renderer.shadowMap.enabled = true;
			renderer.shadowMap.type = THREE.PCFSoftShadowMap; // фільтрує карти тіней з використанням алгоритму 
			// процентної фільтрації (PCF) з кращими м'якими тінями, 
			// особливо при використанні карт тіней з низькою якістью.

			// додаємо вивід візуалізатора до html-елементу
			document.body.appendChild(renderer.domElement);
			// створюємо камеру
			var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
			// створюємо сцену, яка буде містити всі наші елементи, такі як об'єкти, камери і джерела світла
			var scene = new THREE.Scene();
			var trackballcontrols = new THREE.TrackballControls(camera, renderer.domElement);

			// додаємо освітлення ambient lighting
			// AmbientLight - це світло, яке освітлює всю сцену. 
			// Воно не має напрямку і освітлює кожен об'єкт сцени в рівній мірі, 
			// незалежно від розташування об'єкта. 
			// Відповідно, у цього світла немає позиції на осі координат. 
			// Цей світ не може використовуватися для створення тіней.
			var ambiColor = "#e3e1e1";
			var ambientLight = new THREE.AmbientLight(ambiColor);
			scene.add(ambientLight);

			// Джерело DirectionalLight можна розглядати як джерело світла, що знаходиться дуже далеко.
			// Весь світ промені, які він випромінює, паралельні один одному.
			var directionalLight = new THREE.DirectionalLight(0xffffff);
			directionalLight.position.set(-10, 100, 0);

			directionalLight.castShadow = true; // Якщо встановлено значення true, це
			// світло відкидає тіні.
			directionalLight.shadowCameraNear = 2; // Тіньова камера перспективи 
			directionalLight.shadowCameraFar = 200;
			directionalLight.shadowCameraLeft = -50;
			directionalLight.shadowCameraRight = 50;
			directionalLight.shadowCameraTop = 50;
			directionalLight.shadowCameraBottom = -50;

			directionalLight.distance = 0;
			directionalLight.intensity = 0.5;
			directionalLight.shadowMapHeight = 1024; // Висота текстури карти тіней в пікселях.
			// За замовчуванням - 512.
			directionalLight.shadowMapWidth = 1024; // Ширина текстури карти тіней в пікселях.
			// За замовчуванням - 512.


			scene.add(directionalLight);


			var circleGeometry = new THREE.CircleGeometry(20, 32);
			var circleMaterial = new THREE.MeshPhongMaterial({ color: 0x9999ff, side: THREE.DoubleSide });
			var circle = new THREE.Mesh(circleGeometry, circleMaterial);

			circle.rotation.x = Math.PI / 2;
			circle.position.y = 7;
			circle.position.z = 0;
			circle.receiveShadow = true;
			circle.castShadow = true;

			scene.add(circle);

			var circleGeometry_2 = new THREE.CircleGeometry(30, 32);
			var circleMaterial_2 = new THREE.MeshPhongMaterial({ color: 0xff00ff, side: THREE.DoubleSide });
			var circle2 = new THREE.Mesh(circleGeometry_2, circleMaterial_2);

			circle2.rotation.x = Math.PI / 2;
			circle2.position.y = 0;
			circle2.position.z = 0;
			circle2.receiveShadow = true;

			scene.add(circle2);


			var sphereGeometry = new THREE.SphereGeometry(3, 8, 8);
			var sphereMaterial = new THREE.MeshPhongMaterial({ color: 0xffffff, side: THREE.DoubleSide });
			var sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);

			sphere.position.set(-4, 10, 0);
			sphere.receiveShadow = true;
			sphere.castShadow = true;

			scene.add(sphere);

			camera.position.x = 60;
			camera.position.y = 20;
			camera.position.z = 0;
			camera.lookAt(scene.position);

			renderScene();

			function renderScene() {

				sphere.rotation.x += 0.02;
				sphere.rotation.y += 0.02;
				sphere.rotation.z += 0.02;

				trackballcontrols.update();


				requestAnimationFrame(renderScene);

				renderer.render(scene, camera);
			}

		};


	</script>
</body>

</html>